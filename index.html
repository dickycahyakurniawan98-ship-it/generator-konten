<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Caption Film Sosial Media</title>
    <!-- Memuat Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Custom styles for better aesthetics */
        body {
            background-color: #f7f9fb;
            color: #1f2937;
        }
        .caption-card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
        }
        .cta-button {
            transition: all 0.2s;
        }
        .cta-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        /* Active state for buttons */
        .btn-active {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
        }
        /* Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(3px);
            z-index: 50; /* Tailwind z-50 */
        }
        /* Fix for scroll on certain mobile browsers (ensure html/body are full height) */
        html {
            height: 100%;
        }
    </style>
</head>
<!-- Perubahan utama di sini: Menggunakan h-screen dan overflow-hidden -->
<body class="font-sans h-screen flex items-center justify-center p-4 sm:p-8 overflow-hidden">

    <!-- Perubahan utama di sini: Menggunakan h-full (tinggi penuh) pada ponsel, dan mengurangi padding (p-4) -->
    <div class="w-full h-full sm:h-auto max-w-4xl bg-white p-4 sm:p-10 rounded-xl caption-card overflow-y-auto">
        
        <!-- Area Input Judul Konten -->
        <div class="mb-4">
            <!-- Wrapper Flex untuk label dan teks "DICAKUN" -->
            <div class="flex justify-between items-center mb-2">
                <label for="movieTitle" class="block text-lg font-semibold text-gray-700">Judul Konten:</label>
                <span class="text-xs font-bold text-indigo-500 uppercase tracking-widest">DICAKUN</span>
            </div>
            <input type="text" id="movieTitle" placeholder="Contoh: Petualangan Sherina 2 atau Attack on Titan"
                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg">
        </div>
        
        <!-- Grid untuk Tipe Konten dan Genre (Berdampingan di layar besar) -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-4 pt-3 border-t border-gray-200">
            
            <!-- Column 1: Pilihan Tipe Konten (Multi-Select Buttons) -->
            <div class="text-center">
                <label class="block text-lg font-semibold text-gray-700 mb-2">Pilih Tipe Konten (Multi-Pilih):</label>
                <!-- Dikeraskan: gap-1 sm:gap-2 untuk rapat -->
                <div class="flex flex-wrap justify-center gap-1 sm:gap-2">
                    <button data-type="movie" onclick="selectMediaType('movie')" class="btn-type py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-indigo-500 hover:bg-indigo-600 text-white font-bold cta-button">Movie</button>
                    <button data-type="anime" onclick="selectMediaType('anime')" class="btn-type py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold cta-button">Anime</button>
                    <button data-type="donghua" onclick="selectMediaType('donghua')" class="btn-type py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold cta-button">Donghua</button>
                </div>
                <p id="typeInfo" class="text-sm text-gray-500 mt-2">Tipe aktif (1): Movie</p>
            </div>


            <!-- Column 2: Pilihan Genre (Multi-Select Buttons) -->
            <div class="text-center">
                <label class="block text-lg font-semibold text-gray-700 mb-2">Pilih Genre (Multi-Pilih):</label>
                <!-- Dikeraskan: gap-1 sm:gap-2 untuk rapat -->
                <div class="flex flex-wrap justify-center gap-1 sm:gap-2">
                    <button data-genre="action" onclick="selectGenre('action')" class="btn-genre py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-indigo-500 hover:bg-indigo-600 text-white font-bold cta-button">Aksi</button>
                    <button data-genre="comedy" onclick="selectGenre('comedy')" class="btn-genre py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold cta-button">Komedi</button>
                    <button data-genre="horror" onclick="selectGenre('horror')" class="btn-genre py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold cta-button">Horor</button>
                    <button data-genre="romance" onclick="selectGenre('romance')" class="btn-genre py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold cta-button">Romantis</button>
                    <button data-genre="scifi" onclick="selectGenre('scifi')" class="btn-genre py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold cta-button">Sci-Fi</button>
                    <button data-genre="other" onclick="selectGenre('other')" class="btn-genre py-1.5 px-3 text-sm rounded-lg sm:py-2 sm:px-3 sm:rounded-xl sm:text-base bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold cta-button">Lainnya</button>
                </div>
                <p id="genreInfo" class="text-sm text-gray-500 mt-2">Genre aktif (1): Aksi</p>
            </div>
        </div>


        <!-- Grid for Dropdowns (Region and Social Media) -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-4 pt-3 border-t border-gray-200">
            <!-- Column 1: Pilih Wilayah Hashtag (Single-Select Dropdown) -->
            <div>
                <label for="hashtagRegion" class="block text-lg font-semibold text-gray-700 mb-2">Pilih Wilayah Hashtag:</label>
                <select id="hashtagRegion" onchange="updateHashtagRegion()"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg bg-white">
                    <option value="indonesia">Indonesia üáÆüá©</option>
                    <option value="global">Global üåç</option>
                </select>
                <p id="regionInfo" class="text-sm text-gray-500 mt-2">Wilayah aktif: Indonesia üáÆüá©</p>
            </div>
            
            <!-- Column 2: Pilih Sosial Media (Single-Select Dropdown) -->
            <div>
                <label for="socialMedia" class="block text-lg font-semibold text-gray-700 mb-2">Pilih Sosial Media:</label>
                <select id="socialMedia" onchange="updateSocialMedia()"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg bg-white">
                    <option value="igfb">Instagram & Facebook</option>
                    <option value="twitter">Twitter (X)</option>
                </select>
                <p id="mediaInfo" class="text-sm text-gray-500 mt-2">Media aktif: Instagram & Facebook</p>
            </div>
        </div>
        
        <!-- Grid for Hashtag Count and URL Input (Stays compact) -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 sm:gap-8 mb-6 pt-3 border-t border-gray-200">
            <!-- Column 1: Jumlah Hashtag Target -->
            <div>
                <label for="hashtagCount" class="block text-lg font-semibold text-gray-700 mb-2">Jumlah Hashtag Target:</label>
                <input type="number" id="hashtagCount" value="8" min="1" max="30" 
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                <p class="text-sm text-gray-500 mt-2">Disarankan antara 8-15 untuk jangkauan optimal.</p>
            </div>
            
            <!-- Column 2: Link Website/URL Konten -->
            <div>
                <label for="websiteUrl" class="block text-lg font-semibold text-gray-700 mb-2">Link Website/URL Konten:</label>
                <input type="url" id="websiteUrl" placeholder="Contoh: https://linktr.ee/filmanda"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                <p class="text-sm text-gray-500 mt-2">Link ini akan otomatis ditambahkan ke caption Twitter/X.</p>
            </div>
        </div>
        
        <!-- Tombol Generate -->
        <div class="mb-8">
            <button onclick="generateCaptions()" 
                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-extrabold text-xl py-3 rounded-xl cta-button shadow-lg shadow-indigo-500/50">
                ‚ú® Generate Caption Sekarang
            </button>
        </div>
    </div>
    
    <!-- MODAL POPUP HASIL CAPTION (Tersembunyi secara default) -->
    <div id="captionModal" class="hidden fixed inset-0 modal-backdrop flex items-center justify-center p-4">
        <div class="bg-white rounded-xl max-w-lg w-full p-6 sm:p-8 relative caption-card animate-in fade-in zoom-in-50">
            <!-- Tombol Tutup -->
            <button onclick="closeModal()" class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <!-- Konten Modal -->
            <div id="outputCard" class="space-y-4">
                <h2 id="modalOutputTitle" class="text-2xl font-bold text-indigo-700 flex items-center">
                    Hasil Caption:
                </h2>
                <textarea id="modalCaptionOutput" rows="8" readonly
                          class="w-full p-4 border border-gray-300 bg-gray-50 rounded-lg resize-none text-base text-gray-800"
                          placeholder="Hasil caption akan muncul di sini..."></textarea>
                
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4">
                    <button onclick="copyToClipboard('modalCaptionOutput', 'copyModalOutput')" id="copyModalOutput"
                            class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl cta-button">
                        Copy Caption
                    </button>
                    <button onclick="closeModal()"
                            class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-xl cta-button">
                        Tutup
                    </button>
                </div>
            </div>
        </div>
    </div>


    <script>
        // --- DATA HASHTAG GLOBAL DAN REGIONAL ---

        const indonesianHashtags = [
            "#NontonFilm", "#FilmBaru", "#Bioskop", "#ReviewFilm", "#WajibTonton",
            "#FilmKeren", "#FilmViral", "#CinephileID", "#MovieOfTheDay"
        ];

        const globalHashtags = [
            "#MovieTime", "#FilmFreak", "#NewRelease", "#Cinema", "#MovieLover",
            "#FilmRecommendation", "#MustWatch", "#BoxOffice", "#MovieReview",
        ];

        const genreHashtags = {
            action: {
                label: "Aksi",
                indonesia: ["#Aksi", "#Tegang", "#Laga", "#Adrenalin"],
                global: ["#ActionMovie", "#Thriller", "#HighOctane", "#Stunts""#Action","#TakeAction","#ActNow","#StandUp","#MakeADifference","#ChangeTheWorld","#BeTheChange","#GlobalAction","#SocialJustice","#Equality","#HumanRights","#ClimateAction","#JusticeForAll","#Activism","#SpeakUp","#PowerToThePeople","#UnitedWeStand","#TogetherWeCan","#RiseUp","#Solidarity","#ChangeMakers","#NoMoreSilence","#LeadTheChange","#HandsTogether"]
            },
            comedy: {
                label: "Komedi",
                indonesia: ["#Komedi", "#Ngakak", "#Lucu", "#Hiburan"],
                global: ["#ComedyMovie", "#Funny", "#Laugh", "#Blockbuster"]
            },
            horror: {
                label: "Horor",
                indonesia: ["#Horor", "#Seram", "#UjiNyali", "#Mencekam"],
                global: ["#HorrorMovie", "#Scary", "#JumpScare", "#Creepy"]
            },
            romance: {
                label: "Romantis",
                indonesia: ["#Romantis", "#Baper", "#Cinta", "#DramaCinta"],
                global: ["#RomanceMovie", "#LoveStory", "#DateNight", "#Sweet"]
            },
            scifi: { 
                label: "Sci-Fi",
                indonesia: ["#FiksiIlmiah", "#MasaDepan", "#Teknologi", "#Alien"],
                global: ["#SciFi", "#Future", "#Cyberpunk", "#SpaceOpera"]
            },
            other: {
                label: "Lainnya",
                indonesia: ["#FilmSpesial", "#DocumentaryID", "#IndieID"],
                global: ["#MustSee", "#IndieFilm", "#FantasyFilm"]
            }
        };

        const mediaTypeHashtags = {
            movie: {
                label: "Movie",
                indonesia: ["#FilmIndonesia", "#KaryaAnakBangsa", "#BioskopIndonesia", "#FilmLayarLebar"],
                global: ["#FeatureFilm", "#Hollywood", "#CinemaLife", "#MovieMagic"]
            },
            anime: {
                label: "Anime",
                indonesia: ["#AnimeIndonesia", "#WibuIndonesia", "#KartunJepang", "#OtakuID", "#AnimeManga"],
                global: ["#Anime", "#Manga", "#Otaku", "#JapanAnime", "#AnimeFan", "#Shonen"]
            },
            donghua: {
                label: "Donghua",
                indonesia: ["#DonghuaID", "#SerialChina", "#AnimasiTiongkok", "#WuxiaIndonesia", "#Cultivation"],
                global: ["#Donghua", "#ChineseAnimation", "#WuxiaDrama", "#Manhua", "#AncientChina"]
            }
        };

        // --- STATE APLIKASI (DIUBAH KEMBALI KE ARRAY UNTUK MULTI-SELECT) ---
        let selectedGenres = ['action']; 
        let selectedMediaTypes = ['movie']; 
        
        // Tetap single-select:
        let selectedRegion = 'indonesia'; 
        let selectedSocialMedia = 'igfb'; 

        // --- FUNGSI UTILITY ---

        // Mengambil N hashtag acak dari array
        function getRandomHashtags(arr, count) {
            count = Math.min(count, arr.length);
            
            const shuffled = arr.slice();
            let i = arr.length;
            while (i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled.slice(0, count);
        }

        // Fungsi Toggle untuk Multi-Select pada Tombol
        function toggleSelection(key, selectionArray, dataMap, btnClass, infoId, dataKey) {
            const btn = document.querySelector(`.${btnClass}[${dataKey}="${key}"]`);
            const index = selectionArray.indexOf(key);
            
            if (index > -1) {
                // Hapus (Deselect)
                if (selectionArray.length > 1) {
                    selectionArray.splice(index, 1); 
                    btn.classList.remove('btn-active', 'bg-indigo-500', 'hover:bg-indigo-600', 'text-white');
                    btn.classList.add('bg-gray-300', 'hover:bg-gray-400', 'text-gray-800');
                } else {
                    // Mencegah deselect jika hanya satu yang terpilih
                    return; 
                }
            } else {
                // Tambah (Select)
                selectionArray.push(key);
                btn.classList.add('btn-active', 'bg-indigo-500', 'hover:bg-indigo-600', 'text-white');
                btn.classList.remove('bg-gray-300', 'hover:bg-gray-400', 'text-gray-800');
            }

            let labels = selectionArray.map(k => dataMap[k].label.split(' ')[0]).join(', ');
            document.getElementById(infoId).textContent = `${infoId === 'genreInfo' ? 'Genre' : 'Tipe'} aktif (${selectionArray.length}): ${labels}`;
        }

        // Pembungkus fungsi toggle
        function selectGenre(genre) {
            toggleSelection(genre, selectedGenres, genreHashtags, 'btn-genre', 'genreInfo', 'data-genre');
        }

        function selectMediaType(type) {
             toggleSelection(type, selectedMediaTypes, mediaTypeHashtags, 'btn-type', 'typeInfo', 'data-type');
        }

        // --- FUNGSI UPDATE DROPDOWN (TETAP SINGLE-SELECT) ---

        function updateHashtagRegion() {
            const select = document.getElementById('hashtagRegion');
            selectedRegion = select.value;
            
            const label = selectedRegion === 'indonesia' ? 'Indonesia üáÆüá©' : 'Global üåç';
            document.getElementById('regionInfo').textContent = `Wilayah aktif: ${label}`;
        }
        
        function updateSocialMedia() {
            const select = document.getElementById('socialMedia');
            selectedSocialMedia = select.value;
            
            // Hanya update info text, tidak perlu update output card karena output sekarang ada di modal
            const infoElement = document.getElementById('mediaInfo');
            infoElement.textContent = `Media aktif: ${selectedSocialMedia === 'igfb' ? 'Instagram & Facebook' : 'Twitter (X)'}`;
        }

        // --- MODAL CONTROL FUNCTIONS ---

        function showModal(caption, title) {
            const modal = document.getElementById('captionModal');
            const modalTextarea = document.getElementById('modalCaptionOutput');
            const modalTitle = document.getElementById('modalOutputTitle');

            // Set title and content based on the platform
            modalTitle.innerHTML = title;
            modalTextarea.value = caption;
            
            // Adjust card color based on platform
            const card = modal.querySelector('.bg-white');
            if (title.includes('Instagram & Facebook')) {
                modalTitle.classList.remove('text-blue-700');
                modalTitle.classList.add('text-indigo-700');
            } else if (title.includes('Twitter')) {
                modalTitle.classList.remove('text-indigo-700');
                modalTitle.classList.add('text-blue-700');
            }

            modal.classList.remove('hidden');
        }

        function closeModal() {
            const modal = document.getElementById('captionModal');
            modal.classList.add('hidden');
            // Reset copy button text
            document.getElementById('copyModalOutput').textContent = 'Copy Caption';
        }


        // --- FUNGSI UTAMA GENERASI CAPTION ---
        
        function generateCaptions() {
            const titleInput = document.getElementById('movieTitle');
            const title = titleInput.value.trim();
            const hashtagCountInput = document.getElementById('hashtagCount');
            const websiteUrl = document.getElementById('websiteUrl').value.trim();
            
            // Validasi Judul
            if (!title) {
                showModal("Silakan isi Judul Konten terlebih dahulu.", "Peringatan");
                return;
            }

            let desiredCount = parseInt(hashtagCountInput.value, 10);
            if (isNaN(desiredCount) || desiredCount < 1) {
                desiredCount = 8;
                hashtagCountInput.value = 8;
            } else if (desiredCount > 30) {
                desiredCount = 30;
                hashtagCountInput.value = 30;
            }

            // Kumpulkan SEMUA Hashtag yang mungkin ke dalam satu Set unik
            let allPossibleHashtags = new Set();
            const cleanedTitle = title.replace(/\s+/g, '').replace(/[^a-zA-Z0-9]/g, '');
            const titleHashtag = '#' + cleanedTitle;
            allPossibleHashtags.add(titleHashtag);
            
            const regionKey = selectedRegion; 
            const generalList = (regionKey === 'indonesia') ? indonesianHashtags : globalHashtags;
            generalList.forEach(tag => allPossibleHashtags.add(tag));
            
            selectedGenres.forEach(genreKey => {
                if (genreHashtags[genreKey] && genreHashtags[genreKey][regionKey]) {
                    genreHashtags[genreKey][regionKey].forEach(tag => allPossibleHashtags.add(tag));
                }
            });

            selectedMediaTypes.forEach(typeKey => {
                if (mediaTypeHashtags[typeKey] && mediaTypeHashtags[typeKey][regionKey]) {
                    mediaTypeHashtags[typeKey][regionKey].forEach(tag => allPossibleHashtags.add(tag));
                }
            });

            // Konversi ke Array, Acak, dan Batasi jumlahnya
            const poolArray = Array.from(allPossibleHashtags).filter(tag => tag !== titleHashtag);
            const numTagsFromPool = desiredCount - 1; 

            let selectedHashtags = getRandomHashtags(poolArray, numTagsFromPool);
            
            // Pastikan hashtag judul ada di depan
            if (!selectedHashtags.includes(titleHashtag)) {
                selectedHashtags.unshift(titleHashtag);
            } else {
                const index = selectedHashtags.indexOf(titleHashtag);
                if (index > -1) {
                    selectedHashtags.splice(index, 1); 
                    selectedHashtags.unshift(titleHashtag);
                }
            }

            if (selectedHashtags.length > desiredCount) {
                selectedHashtags = selectedHashtags.slice(0, desiredCount);
            }
            
            // Acak ulang sisa hashtag agar tidak terlalu predictable, tapi pertahankan title di depan
            if (selectedHashtags.length > 1) {
                const titleTag = selectedHashtags.shift();
                const remainingTags = getRandomHashtags(selectedHashtags, selectedHashtags.length);
                selectedHashtags = [titleTag, ...remainingTags];
            }

            const finalHashtagString = selectedHashtags.join(' '); 

            // Tampilkan Caption berdasarkan selectedSocialMedia
            let finalCaption = '';
            let displayTitle = '';

            if (selectedSocialMedia === 'igfb') {
                displayTitle = `Hasil Caption: Instagram & Facebook <svg class="w-6 h-6 ml-2 text-pink-500" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.779 1.674 4.931 4.931.058 1.267.07 1.647.07 4.85 0 3.204-.012 3.584-.07 4.85-6.738 3.252-4.931 4.779-4.931 4.931-.148.058-1.267.07-4.85.07-3.204 0-3.584-.012-4.85-.07-3.252-.148-4.779-1.674-4.931-4.931-.058-1.267-.07-1.647-.07-4.85 0-3.204.012-3.584.07-4.85C2.652 3.837 4.178 2.31 7.435 2.163 8.7 2.105 9.08 2.093 12 2.093zM12 0c-3.259 0-3.666.014-4.945.071C3.39 0.239 0 3.63 0 8.051c0 1.278.014 1.685.071 4.945.148 3.259 3.538 4.787 4.93 4.93.057 1.28.071 1.687.071 4.945 0 3.259-.014 3.666-.071 4.945-.148 3.259-3.538 4.787-4.93 4.93-.057 1.28-.071 1.687-.071 4.945 0-3.259-.014-3.666-.071 4.945zM12 4.419a7.581 7.581 0 100 15.162 7.581 7.581 0 000-15.162zM12 1.44a10.56 10.56 0 110 21.12 10.56 10.56 0 010-21.12zm7.26 3.639c-.752 0-1.365.613-1.365 1.365s.613 1.365 1.365 1.365 1.365-.613 1.365-1.365-.613-1.365-1.365-1.365zM12 7.025c-2.748 0-4.975 2.227-4.975 4.975s2.227 4.975 4.975 4.975 4.975-2.227 4.975-4.975-2.227-4.975-4.975-4.975zM12 8.44a3.56 3.56 0 100 7.12 3.56 3.56 0 000-7.12z"/></svg>`;

                finalCaption = `${title}
Full movie in bioüé•
            
${finalHashtagString}`;
                
            } else if (selectedSocialMedia === 'twitter') {
                displayTitle = `Hasil Caption: Twitter (X) <svg class="w-6 h-6 ml-2 text-gray-800" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.216-6.817L4.99 21.75H1.68l7.228-8.26L2.5 2.25h3.376l4.417 5.764L18.244 2.25zm-2.88 18.39l.666.9h-2.14l-4.13-5.385l-4.877 5.385H1.27l7.558-8.63L1.25 2.64h2.14l4.13 5.385L16.2 2.64h3.69l-7.558 8.63 7.558 8.415z"/></svg>`;

                let twitterCaptionContent = `${title}
Full movieüé•üëá`; 
                
                if (websiteUrl) {
                    twitterCaptionContent += `
${websiteUrl}`;
                } 
                
                finalCaption = `${twitterCaptionContent}
        
${finalHashtagString}`;
            }

            // Tampilkan hasil di modal
            showModal(finalCaption, displayTitle);
        }

        // Fungsi untuk menyalin ke clipboard (Telah diperbarui untuk menargetkan elemen di modal)
        function copyToClipboard(elementId, buttonId) {
            const element = document.getElementById(elementId);
            const button = document.getElementById(buttonId);

            try {
                element.select();
                element.setSelectionRange(0, 99999); 
                document.execCommand('copy');
                button.textContent = 'Tersalin!';
                setTimeout(() => {
                    button.textContent = 'Copy Caption';
                }, 1500);
            } catch (err) {
                console.error('Gagal menyalin:', err);
                button.textContent = 'Gagal Copy';
            }
        }

        // --- INISIALISASI ---
        window.onload = function() {
            const initVisuals = (arr, btnClass, dataMap, infoId) => {
                arr.forEach(key => {
                    const btn = document.querySelector(`.${btnClass}[data-${btnClass.split('-')[1]}="${key}"]`);
                    if (btn) {
                        btn.classList.add('btn-active', 'bg-indigo-500', 'hover:bg-indigo-600', 'text-white');
                        btn.classList.remove('bg-gray-300', 'hover:bg-gray-400', 'text-gray-800');
                    }
                });
                
                let labels = arr.map(k => dataMap[k].label.split(' ')[0]).join(', ');
                document.getElementById(infoId).textContent = `${infoId === 'genreInfo' ? 'Genre' : 'Tipe'} aktif (${arr.length}): ${labels}`;
            };
            
            initVisuals(selectedMediaTypes, 'btn-type', mediaTypeHashtags, 'typeInfo');
            initVisuals(selectedGenres, 'btn-genre', genreHashtags, 'genreInfo');

            updateHashtagRegion(); 
            updateSocialMedia();   
        };
    </script>

</body>
</html>
